<div
  class='min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 mt-20'
  x-data='{ new_address: false }'
  x-cloak
>
  <div class='max-w-7xl mx-auto px-4 py-8 lg:px-8'>
    <!-- Page Header -->
    <div class='bg-white rounded-2xl shadow-sm border border-gray-200 p-8 mb-8'>
      <div class='flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6'>
        <div class='flex-1'>
          <h1 class='text-4xl font-bold text-gray-900 mb-2'>Addresses</h1>
          <p class='text-gray-600'>
            Manage your delivery and billing addresses
          </p>
        </div>
        <div class='flex flex-col sm:flex-row gap-4'>
          <button
            x-on:click='new_address = true'
            type='button'
            class='inline-flex cursor-pointer items-center gap-2 px-6 py-3 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors font-medium'
          >
            <svg
              class='w-4 h-4'
              fill='none'
              stroke='currentColor'
              viewBox='0 0 24 24'
            >
              <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 6v6m0 0v6m0-6h6m-6 0H6'></path>
            </svg>
            Create new address
          </button>
          <a
            href='{{ routes.account_url }}'
            class='inline-flex items-center gap-2 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors'
          >
            <svg
              class='w-4 h-4'
              fill='none'
              stroke='currentColor'
              viewBox='0 0 24 24'
            >
              <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M10 19l-7-7m0 0l7-7m-7 7h18'></path>
            </svg>
            Back to account
          </a>
        </div>
      </div>
    </div>

    <!-- Addresses Grid -->
    <div class='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6'>
      {% paginate customer.addresses by 10 %}
        {% for address in customer.addresses %}
          <div x-data='{ showEditModal: false }'>
            <div
              class='
                bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-lg
                {% if address == customer.default_address %}
                  border-green-500 shadow-green-100
                {% endif %}
              '
            >
              <!-- Address Header -->
              <div class='flex justify-between items-center p-6 pb-0'>
                <div class='flex gap-2'>
                  {% if address == customer.default_address %}
                    <span class='inline-flex items-center gap-1.5 px-3 py-1.5 bg-green-50 text-green-700 border border-green-200 rounded-full text-xs font-semibold uppercase tracking-wide'>
                      <svg
                        class='w-3.5 h-3.5'
                        fill='none'
                        stroke='currentColor'
                        viewBox='0 0 24 24'
                      >
                        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M5 13l4 4L19 7'></path>
                      </svg>
                      Default
                    </span>
                  {% endif %}
                </div>
              </div>

              <!-- Address Content -->
              <div class='flex items-start gap-4 p-6'>
                <div class='w-12 h-12 bg-gradient-to-br from-black to-gray-800 rounded-xl flex items-center justify-center flex-shrink-0'>
                  <svg
                    class='w-6 h-6 text-white'
                    fill='none'
                    stroke='currentColor'
                    viewBox='0 0 24 24'
                  >
                    <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z'></path>
                    <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M15 11a3 3 0 11-6 0 3 3 0 016 0z'></path>
                  </svg>
                </div>

                <div class='flex-1 min-w-0'>
                  <h3 class='text-lg font-semibold text-gray-900 mb-2'>
                    {{ address.first_name }}
                    {{ address.last_name }}
                  </h3>
                  <div class='space-y-1'>
                    {% if address.address1 != blank %}
                      <div class='text-sm text-gray-600'>
                        {{ address.address1 }}
                      </div>
                    {% endif %}
                    {% if address.address2 != blank %}
                      <div class='text-sm text-gray-600'>
                        {{ address.address2 }}
                      </div>
                    {% endif %}
                    {% if address.city != blank %}
                      <div class='text-sm text-gray-600'>
                        {{ address.city }}
                      </div>
                    {% endif %}
                    {% if address.province != blank %}
                      <div class='text-sm text-gray-600'>
                        {{ address.province }}
                      </div>
                    {% endif %}
                    {% if address.country != blank %}
                      <div class='text-sm text-gray-600'>
                        {{ address.country }}
                      </div>
                    {% endif %}
                    {% if address.zip != blank %}
                      <div class='text-sm text-gray-600'>{{ address.zip }}</div>
                    {% endif %}
                  </div>
                </div>
              </div>

              <!-- Address Actions -->
              <div class='flex gap-3 p-6 pt-2 bg-gray-50 border-t border-gray-200'>
                <button
                  x-on:click='showEditModal = true'
                  class='flex-1 inline-flex cursor-pointer items-center gap-2 px-4 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-colors font-medium text-sm'
                >
                  <svg
                    class='w-4 h-4'
                    fill='none'
                    stroke='currentColor'
                    viewBox='0 0 24 24'
                  >
                    <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z'></path>
                  </svg>
                  Edit
                </button>
                <button
                  class='flex-1 inline-flex cursor-pointer items-center gap-2 px-4 py-2 bg-white text-red-600 border border-red-200 rounded-lg hover:bg-red-50 hover:border-red-300 transition-colors font-medium text-sm'
                  data-url='{{ address.url }}'
                  data-delete-address
                >
                  <svg
                    class='w-4 h-4'
                    fill='none'
                    stroke='currentColor'
                    viewBox='0 0 24 24'
                  >
                    <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16'></path>
                  </svg>
                  Delete
                </button>
              </div>

              <!-- Hidden form for delete -->
              <form method='post' action='{{ address.url }}' class='hidden'>
                <input type='hidden' name='_method' value='delete'>
              </form>
            </div>

            <!-- Edit Address Modal -->
            <div
              x-show='showEditModal'
              x-on:click.self='showEditModal = false'
              x-transition:enter='transition ease-out duration-300'
              x-transition:enter-start='opacity-0'
              x-transition:enter-end='opacity-100'
              x-transition:leave='transition ease-in duration-200'
              x-transition:leave-start='opacity-100'
              x-transition:leave-end='opacity-0'
              class='fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4'
              style='display: none;'
            >
              <div class='bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto'>
                <div class='flex justify-between items-center p-6 border-b border-gray-200'>
                  <h2 class='text-2xl font-semibold text-gray-900'>
                    Edit Address
                  </h2>
                  <button
                    x-on:click='showEditModal = false'
                    class='p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors'
                  >
                    <svg
                      class='w-5 h-5'
                      fill='none'
                      stroke='currentColor'
                      viewBox='0 0 24 24'
                    >
                      <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'></path>
                    </svg>
                  </button>
                </div>

                {% form "customer_address", address %}
                  <div class='p-6'>
                    <div class='grid grid-cols-1 md:grid-cols-2 gap-6 mb-6'>
                      <div>
                        <label
                          for='address_fname_{{ form.id }}'
                          class='block text-sm font-medium text-gray-700 mb-2'
                          >First Name</label
                        >
                        <input
                          type='text'
                          name='address[first_name]'
                          id='address_fname_{{ form.id }}'
                          value='{{ form.first_name }}'
                          class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black'
                        >
                      </div>
                      <div>
                        <label
                          for='address_lname_{{ form.id }}'
                          class='block text-sm font-medium text-gray-700 mb-2'
                          >Last Name</label
                        >
                        <input
                          type='text'
                          name='address[last_name]'
                          id='address_lname_{{ form.id }}'
                          value='{{ form.last_name }}'
                          class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black'
                        >
                      </div>
                      <div>
                        <label
                          for='address_company_{{ form.id }}'
                          class='block text-sm font-medium text-gray-700 mb-2'
                          >Company</label
                        >
                        <input
                          type='text'
                          name='address[company]'
                          id='address_company_{{ form.id }}'
                          value='{{ form.company }}'
                          class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black'
                        >
                      </div>
                      <div>
                        <label
                          for='address_phone_{{ form.id }}'
                          class='block text-sm font-medium text-gray-700 mb-2'
                          >Phone Number</label
                        >
                        <input
                          type='tel'
                          name='address[phone]'
                          id='address_phone_{{ form.id }}'
                          value='{{ form.phone }}'
                          class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black'
                        >
                      </div>
                      <div class='md:col-span-2'>
                        <label
                          for='address_address1_{{ form.id }}'
                          class='block text-sm font-medium text-gray-700 mb-2'
                          >Address Line 1</label
                        >
                        <input
                          type='text'
                          name='address[address1]'
                          id='address_address1_{{ form.id }}'
                          value='{{ form.address1 }}'
                          class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black'
                        >
                      </div>
                      <div class='md:col-span-2'>
                        <label
                          for='address_address2_{{ form.id }}'
                          class='block text-sm font-medium text-gray-700 mb-2'
                          >Address Line 2 (Optional)</label
                        >
                        <input
                          type='text'
                          name='address[address2]'
                          id='address_address2_{{ form.id }}'
                          value='{{ form.address2 }}'
                          class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black'
                        >
                      </div>
                      <div>
                        <label
                          for='address_city_{{ form.id }}'
                          class='block text-sm font-medium text-gray-700 mb-2'
                          >City</label
                        >
                        <input
                          type='text'
                          name='address[city]'
                          id='address_city_{{ form.id }}'
                          value='{{ form.city }}'
                          class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black'
                        >
                      </div>
                      <div>
                        <label
                          for='address_country_{{ form.id }}'
                          class='block text-sm font-medium text-gray-700 mb-2'
                          >Country</label
                        >
                        <select
                          name='address[country]'
                          id='address_country_{{ form.id }}'
                          value='{{ form.country }}'
                          class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black'
                          data-country-selector
                          data-id='{{ form.id }}'
                        >
                          {{ all_country_option_tags }}
                        </select>
                      </div>
                      <div>
                        <label
                          for='address_province_{{ form.id }}'
                          class='block text-sm font-medium text-gray-700 mb-2'
                          >State/Province</label
                        >
                        <select
                          name='address[province]'
                          id='address_province_{{ form.id }}'
                          value='{{ form.province }}'
                          class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black'
                        ></select>
                      </div>
                      <div>
                        <label
                          for='address_zip_{{ form.id }}'
                          class='block text-sm font-medium text-gray-700 mb-2'
                          >ZIP/Postal Code</label
                        >
                        <input
                          type='text'
                          name='address[zip]'
                          id='address_zip_{{ form.id }}'
                          value='{{ form.zip }}'
                          class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-black'
                        >
                      </div>
                    </div>

                    <div class='mb-6'>
                      <label class='flex items-center gap-3 cursor-pointer'>
                        {{ form.set_as_default_checkbox }}
                        <span class='text-sm font-medium text-gray-700'
                          >Set as default address</span
                        >
                      </label>
                    </div>

                    <div class='flex justify-end gap-3 pt-6 border-t border-gray-200'>
                      <button
                        type='button'
                        x-on:click='showEditModal = false'
                        class='px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium'
                      >
                        Cancel
                      </button>
                      <button
                        type='submit'
                        class='px-6 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors font-medium'
                      >
                        Save Address
                      </button>
                    </div>
                  </div>
                {% endform %}
              </div>
            </div>
          </div>
        {% endfor %}

        <!-- Add New Address Card -->
        <div class='bg-white rounded-2xl shadow-sm border-2 border-dashed border-gray-300 overflow-hidden transition-all duration-300 hover:-translate-y-1 hover:shadow-lg hover:border-black hover:bg-gray-50'>
          <div class='flex flex-col items-center justify-center p-8 text-center min-h-[280px]'>
            <div class='w-16 h-16 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full flex items-center justify-center mb-4 transition-all duration-300 group-hover:from-black group-hover:to-gray-800'>
              <svg
                class='w-8 h-8 text-gray-500 transition-colors duration-300'
                fill='none'
                stroke='currentColor'
                viewBox='0 0 24 24'
              >
                <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 6v6m0 0v6m0-6h6m-6 0H6'></path>
              </svg>
            </div>
            <h3 class='text-xl font-semibold text-gray-900 mb-2'>
              Add New Address
            </h3>
            <p class='text-gray-600 mb-6 text-sm'>
              Create a new delivery or billing address
            </p>
            <button
              x-on:click='new_address = true'
              class='inline-flex items-center cursor-pointer gap-2 px-6 py-3 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors font-medium'
            >
              <svg
                class='w-4 h-4'
                fill='none'
                stroke='currentColor'
                viewBox='0 0 24 24'
              >
                <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 6v6m0 0v6m0-6h6m-6 0H6'></path>
              </svg>
              Add Address
            </button>
          </div>
        </div>
      {% endpaginate %}
    </div>

    <!-- New Address Modal -->
    <div
      x-show='new_address'
      x-on:click.self='new_address = false'
      class='fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4'
    >
      <div class='bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto'>
        <div class='flex justify-between items-center p-6 border-b border-gray-200'>
          <h2 class='text-2xl font-semibold text-gray-900'>Add New Address</h2>
          <button
            x-on:click='new_address = false'
            class='p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors'
          >
            <svg
              class='w-5 h-5'
              fill='none'
              stroke='currentColor'
              viewBox='0 0 24 24'
            >
              <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'></path>
            </svg>
          </button>
        </div>

        {% form "customer_address", customer.new_address %}
          <div class='p-6'>
            <div class='grid grid-cols-1 md:grid-cols-2 gap-6 mb-6'>
              <div>
                <label
                  for='address_fname_{{ form.id }}'
                  class='block text-sm font-medium text-gray-700 mb-2'
                  >First Name</label
                >
                <input
                  type='text'
                  name='address[first_name]'
                  id='address_fname_{{ form.id }}'
                  value='{{ form.first_name }}'
                  class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                >
              </div>
              <div>
                <label
                  for='address_lname_{{ form.id }}'
                  class='block text-sm font-medium text-gray-700 mb-2'
                  >Last Name</label
                >
                <input
                  type='text'
                  name='address[last_name]'
                  id='address_lname_{{ form.id }}'
                  value='{{ form.last_name }}'
                  class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                >
              </div>
              <div>
                <label
                  for='address_company_{{ form.id }}'
                  class='block text-sm font-medium text-gray-700 mb-2'
                  >Company</label
                >
                <input
                  type='text'
                  name='address[company]'
                  id='address_company_{{ form.id }}'
                  value='{{ form.company }}'
                  class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                >
              </div>
              <div>
                <label
                  for='address_phone_{{ form.id }}'
                  class='block text-sm font-medium text-gray-700 mb-2'
                  >Phone Number</label
                >
                <input
                  type='tel'
                  name='address[phone]'
                  id='address_phone_{{ form.id }}'
                  value='{{ form.phone }}'
                  class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                >
              </div>
              <div class='md:col-span-2'>
                <label
                  for='address_address1_{{ form.id }}'
                  class='block text-sm font-medium text-gray-700 mb-2'
                  >Address Line 1</label
                >
                <input
                  type='text'
                  name='address[address1]'
                  id='address_address1_{{ form.id }}'
                  value='{{ form.address1 }}'
                  class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                >
              </div>
              <div class='md:col-span-2'>
                <label
                  for='address_address2_{{ form.id }}'
                  class='block text-sm font-medium text-gray-700 mb-2'
                  >Address Line 2 (Optional)</label
                >
                <input
                  type='text'
                  name='address[address2]'
                  id='address_address2_{{ form.id }}'
                  value='{{ form.address2 }}'
                  class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                >
              </div>
              <div>
                <label
                  for='address_city_{{ form.id }}'
                  class='block text-sm font-medium text-gray-700 mb-2'
                  >City</label
                >
                <input
                  type='text'
                  name='address[city]'
                  id='address_city_{{ form.id }}'
                  value='{{ form.city }}'
                  class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                >
              </div>
              <div>
                <label
                  for='address_country_{{ form.id }}'
                  class='block text-sm font-medium text-gray-700 mb-2'
                  >Country</label
                >
                <select
                  name='address[country]'
                  id='address_country_{{ form.id }}'
                  value='{{ form.country }}'
                  class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                  data-country-selector
                  data-id='{{ form.id }}'
                >
                  {{ all_country_option_tags }}
                </select>
              </div>
              <div>
                <label
                  for='address_province_{{ form.id }}'
                  class='block text-sm font-medium text-gray-700 mb-2'
                  >State/Province</label
                >
                <select
                  name='address[province]'
                  id='address_province_{{ form.id }}'
                  value='{{ form.province }}'
                  class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                ></select>
              </div>
              <div>
                <label
                  for='address_zip_{{ form.id }}'
                  class='block text-sm font-medium text-gray-700 mb-2'
                  >ZIP/Postal Code</label
                >
                <input
                  type='text'
                  name='address[zip]'
                  id='address_zip_{{ form.id }}'
                  value='{{ form.zip }}'
                  class='w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500'
                >
              </div>
            </div>

            <div class='mb-6'>
              <label class='flex items-center gap-3 cursor-pointer'>
                {{ form.set_as_default_checkbox }}
                <span class='text-sm font-medium text-gray-700'
                  >Set as default address</span
                >
              </label>
            </div>

            <div class='flex justify-end gap-3 pt-6 border-t border-gray-200'>
              <button
                type='button'
                x-on:click='new_address = false'
                class='px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium'
              >
                Cancel
              </button>
              <button
                type='submit'
                class='px-6 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors font-medium'
              >
                Save Address
              </button>
            </div>
          </div>
        {% endform %}
      </div>
    </div>
  </div>
</div>

<script>
  class CustomerAddress {
    constructor() {
      this.initCustomerAddress()
      this.customerAddressesSelector()
      this.initDeleteAddressButtons()
    }

    initDeleteAddressButtons() {
      const deleteButtons = document.querySelectorAll(
        'button[data-delete-address]'
      )
      if (deleteButtons.length < 1) return

      deleteButtons.forEach(button => {
        button.addEventListener('click', function (e) {
          var url = this.dataset.url

          var confirmation = window.confirm(
            'Do you really wish to delete this address?'
          )

          if (confirmation) {
            document.querySelector(`form[action="${url}"]`).submit()
          }
        })
      })
    }

    initCustomerAddress() {
      const allAddressesSelector = document.querySelectorAll(
        'select[data-country-selector]'
      )
      if (allAddressesSelector.length < 1) return

      //console.log(allAddressesSelector);

      allAddressesSelector.forEach(select => {
        var selectedCountry = this.getSelectedCountry(select)

        if (!selectedCountry) return

        var provinces = selectedCountry.dataset.provinces
        var arrayOfProvince = JSON.parse(provinces)

        var provinceSelector = document.querySelector(
          `#address_province_${select.dataset.id}`
        )

        if (arrayOfProvince.length < 1) {
          provinceSelector.setAttribute('disabled', 'disabled')
        } else {
          provinceSelector.removeAttribute('disabled')
        }

        provinceSelector.innerHTML = ''
        var options = ''
        for (var index = 0; index < arrayOfProvince.length; index++) {
          if (
            arrayOfProvince[index][0] === provinceSelector.getAttribute('value')
          ) {
            options += `<option value="${arrayOfProvince[index][0]}" selected>${arrayOfProvince[index][0]}</option>`
          } else {
            options += `<option value="${arrayOfProvince[index][0]}">${arrayOfProvince[index][0]}</option>`
          }
        }

        provinceSelector.innerHTML = options
      })
    }

    getSelectedCountry(select) {
      var option, selectedOption
      for (var index = 0; index < select.options.length; index++) {
        option = select.options[index]

        if (option.value === select.getAttribute('value')) {
          selectedOption = option
          selectedOption.setAttribute('selected', 'selected')
          break
        }
      }

      return selectedOption
    }

    customerAddressesSelector() {
      const addressesSelector = document.querySelectorAll(
        'select[data-country-selector]'
      )
      if (addressesSelector.length < 1) return

      addressesSelector.forEach(select => {
        select.addEventListener('change', function (e) {
          var provinces = this.options[this.selectedIndex].dataset.provinces
          var arrayOfProvince = JSON.parse(provinces)

          var provinceSelector = document.querySelector(
            `#address_province_${this.dataset.id}`
          )

          if (arrayOfProvince.length < 1) {
            provinceSelector.setAttribute('disabled', 'disabled')
          } else {
            provinceSelector.removeAttribute('disabled')
          }

          provinceSelector.innerHTML = ''
          var options = ''
          for (var index = 0; index < arrayOfProvince.length; index++) {
            options += `<option value="${arrayOfProvince[index][0]}">${arrayOfProvince[index][0]}</option>`
          }

          provinceSelector.innerHTML = options
        })
      })
    }
  }

  const customerAddress = new CustomerAddress()
</script>
