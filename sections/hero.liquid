<!-- Hero Carousel Section -->
<div class='relative pt-4'>
  <!-- Scaled Wrapper -->
  <div class='hero-scale-wrap' style='--hero-scale: {{ section.settings.scale_percent | default: 100 }}; --hero-scale-inv: {{ 10000 | divided_by: section.settings.scale_percent | times: 0.01 }}; --hero-radius: {% if section.settings.scale_percent and section.settings.scale_percent < 100 %}{{ section.settings.scale_radius | default: 16 }}px{% else %}0px{% endif %};'>
    <!-- Swiper Container -->
    <swiper-container
    class='hero-swiper'
    pagination='true'
    pagination-clickable='true'
    navigation='false'
    space-between='0'
    centered-slides='true'
    autoplay-delay='{{ section.settings.autoplay_delay | default: 5000 }}'
    autoplay-disable-on-interaction='false'
    loop='true'
  >
    <!-- Slide 1 -->
    <swiper-slide class='relative'>
      {% if section.settings.slide_1_image != blank %}
        <img
          src='{{ section.settings.slide_1_image | img_url: "1920x1080" }}'
          alt='{{ section.settings.slide_1_title | default: "Premium Knives" }}'
          class='w-full h-full object-cover'
        >
      {% else %}
        {{
          "lifestyle-1"
          | placeholder_svg_tag: "w-full h-full bg-gray-800 object-cover"
        }}
      {% endif %}
      {% if section.settings.show_text_overlay %}
        <div class='absolute inset-0 flex items-center justify-center lg:justify-start z-10'>
          <div class='text-center lg:text-left max-w-4xl px-4 lg:ml-16'>
            {% assign s1_shadow = section.settings.slide_1_text_shadow_strength | default: 'soft' %}
            {% assign s1_op = '0.35' %}
            {% case s1_shadow %}
              {% when 'none' %}{% assign s1_op = '0' %}
              {% when 'soft' %}{% assign s1_op = '0.35' %}
              {% when 'medium' %}{% assign s1_op = '0.6' %}
              {% when 'strong' %}{% assign s1_op = '0.85' %}
            {% endcase %}
            <div class='kk-text-wrap inline-block'>
              {% if section.settings.slide_1_text_bg_enable %}
                {% assign s1_bg_op_pct = section.settings.slide_1_text_bg_opacity | default: 50 %}
                {% assign s1_bg_alpha = s1_bg_op_pct | divided_by: 100.0 %}
                <div class='kk-text-bg' style='background-color: {{ section.settings.slide_1_text_bg_color | default: '#000000' | color_modify: 'alpha', s1_bg_alpha }}'></div>
              {% endif %}
              <div class='kk-text-content'>
                <h1 class='text-4xl md:text-6xl font-bold mb-4' style='color: {{ section.settings.slide_1_text_color | default: "#ffffff" }}; text-shadow: 0 2px {{ section.settings.slide_1_text_shadow_blur | default: 6 }}px rgba(0,0,0,{{ s1_op }});'>
                  {{ section.settings.slide_1_title | default: "Premium Knives" }}
                </h1>
                <p class='text-lg md:text-xl mb-8' style='color: {{ section.settings.slide_1_text_color | default: "#ffffff" }}; text-shadow: 0 2px {{ section.settings.slide_1_text_shadow_blur | default: 6 }}px rgba(0,0,0,{{ s1_op }});'>
                  {{
                    section.settings.slide_1_subtitle
                    | default: "Crafted with precision, designed for perfection"
                  }}
                </p>
              </div>
            </div>
            {% if section.settings.slide_1_button_enable and section.settings.slide_1_button_text != blank %}
              <div class='mt-4'>
                <a
                  href='{{ section.settings.slide_1_button_url | default: "/collections/all" }}'
                  class='inline-block font-semibold py-3 px-8 rounded-lg transition-colors duration-300'
                  style='background-color: {{ section.settings.slide_1_button_bg_color | default: "#2563eb" }}; color: {{ section.settings.slide_1_button_text_color | default: "#ffffff" }};'
                >
                  {{ section.settings.slide_1_button_text }}
                </a>
              </div>
            {% endif %}
          </div>
        </div>
      {% endif %}
    </swiper-slide>

    <!-- Slide 2 -->
    <swiper-slide class='relative'>
      {% if section.settings.slide_2_image != blank %}
        <img
          src='{{ section.settings.slide_2_image | img_url: "1920x1080" }}'
          alt='{{ section.settings.slide_2_title | default: "Professional Grade" }}'
          class='w-full h-full object-cover'
        >
      {% else %}
        {{
          "lifestyle-1"
          | placeholder_svg_tag: "w-full h-full bg-gray-800 object-cover"
        }}
      {% endif %}
      {% if section.settings.show_text_overlay %}
        <div class='absolute inset-0 flex items-center justify-center lg:block z-10'>
          <div class='text-center lg:text-left max-w-4xl mx-auto lg:mx-0 px-4 lg:absolute lg:left-16 lg:top-1/2 lg:-translate-y-1/2'>
            {% assign s2_shadow = section.settings.slide_2_text_shadow_strength | default: 'soft' %}
            {% assign s2_op = '0.35' %}
            {% case s2_shadow %}
              {% when 'none' %}{% assign s2_op = '0' %}
              {% when 'soft' %}{% assign s2_op = '0.35' %}
              {% when 'medium' %}{% assign s2_op = '0.6' %}
              {% when 'strong' %}{% assign s2_op = '0.85' %}
            {% endcase %}
            <div class='kk-text-wrap inline-block'>
              {% if section.settings.slide_2_text_bg_enable %}
                {% assign s2_bg_op_pct = section.settings.slide_2_text_bg_opacity | default: 50 %}
                {% assign s2_bg_alpha = s2_bg_op_pct | divided_by: 100.0 %}
                <div class='kk-text-bg' style='background-color: {{ section.settings.slide_2_text_bg_color | default: '#000000' | color_modify: 'alpha', s2_bg_alpha }}'></div>
              {% endif %}
              <div class='kk-text-content'>
                <h1 class='text-4xl md:text-6xl font-bold mb-4' style='color: {{ section.settings.slide_2_text_color | default: "#ffffff" }}; text-shadow: 0 2px {{ section.settings.slide_2_text_shadow_blur | default: 6 }}px rgba(0,0,0,{{ s2_op }});'>
                  {{
                    section.settings.slide_2_title
                    | default: "Professional Grade"
                  }}
                </h1>
                <p class='text-lg md:text-xl mb-8' style='color: {{ section.settings.slide_2_text_color | default: "#ffffff" }}; text-shadow: 0 2px {{ section.settings.slide_2_text_shadow_blur | default: 6 }}px rgba(0,0,0,{{ s2_op }});'>
                  {{
                    section.settings.slide_2_subtitle
                    | default: "Tools that professionals trust"
                  }}
                </p>
              </div>
            </div>
            {% if section.settings.slide_2_button_enable and section.settings.slide_2_button_text != blank %}
              <div class='mt-4'>
                <a
                  href='{{ section.settings.slide_2_button_url | default: "/collections/professional" }}'
                  class='inline-block font-semibold py-3 px-8 rounded-lg transition-colors duration-300'
                  style='background-color: {{ section.settings.slide_2_button_bg_color | default: "#2563eb" }}; color: {{ section.settings.slide_2_button_text_color | default: "#ffffff" }};'
                >
                  {{ section.settings.slide_2_button_text }}
                </a>
              </div>
            {% endif %}
          </div>
        </div>
      {% endif %}
    </swiper-slide>

    <!-- Slide 3 -->
    <swiper-slide class='relative'>
      {% if section.settings.slide_3_image != blank %}
        <img
          src='{{ section.settings.slide_3_image | img_url: "1920x1080" }}'
          alt='{{ section.settings.slide_3_title | default: "Handcrafted Excellence" }}'
          class='w-full h-full object-cover'
        >
      {% else %}
        {{
          "lifestyle-1"
          | placeholder_svg_tag: "w-full h-full bg-gray-800 object-cover"
        }}
      {% endif %}
      {% if section.settings.show_text_overlay %}
        <div class='absolute inset-0 flex items-center justify-center lg:block z-10'>
          <div class='text-center lg:text-left max-w-4xl mx-auto lg:mx-0 px-4 lg:absolute lg:left-16 lg:top-1/2 lg:-translate-y-1/2'>
            {% assign s3_shadow = section.settings.slide_3_text_shadow_strength | default: 'soft' %}
            {% assign s3_op = '0.35' %}
            {% case s3_shadow %}
              {% when 'none' %}{% assign s3_op = '0' %}
              {% when 'soft' %}{% assign s3_op = '0.35' %}
              {% when 'medium' %}{% assign s3_op = '0.6' %}
              {% when 'strong' %}{% assign s3_op = '0.85' %}
            {% endcase %}
            <div class='kk-text-wrap inline-block'>
              {% if section.settings.slide_3_text_bg_enable %}
                {% assign s3_bg_op_pct = section.settings.slide_3_text_bg_opacity | default: 50 %}
                {% assign s3_bg_alpha = s3_bg_op_pct | divided_by: 100.0 %}
                <div class='kk-text-bg' style='background-color: {{ section.settings.slide_3_text_bg_color | default: '#000000' | color_modify: 'alpha', s3_bg_alpha }}'></div>
              {% endif %}
              <div class='kk-text-content'>
                <h1 class='text-4xl md:text-6xl font-bold mb-4' style='color: {{ section.settings.slide_3_text_color | default: "#ffffff" }}; text-shadow: 0 2px {{ section.settings.slide_3_text_shadow_blur | default: 6 }}px rgba(0,0,0,{{ s3_op }});'>
                  {{
                    section.settings.slide_3_title
                    | default: "Handcrafted Excellence"
                  }}
                </h1>
                <p class='text-lg md:text-xl mb-8' style='color: {{ section.settings.slide_3_text_color | default: "#ffffff" }}; text-shadow: 0 2px {{ section.settings.slide_3_text_shadow_blur | default: 6 }}px rgba(0,0,0,{{ s3_op }});'>
                  {{
                    section.settings.slide_3_subtitle
                    | default: "Every piece tells a story of craftsmanship"
                  }}
                </p>
              </div>
            </div>
            {% if section.settings.slide_3_button_enable and section.settings.slide_3_button_text != blank %}
              <div class='mt-4'>
                <a
                  href='{{ section.settings.slide_3_button_url | default: "/pages/about" }}'
                  class='inline-block font-semibold py-3 px-8 rounded-lg transition-colors duration-300'
                  style='background-color: {{ section.settings.slide_3_button_bg_color | default: "#2563eb" }}; color: {{ section.settings.slide_3_button_text_color | default: "#ffffff" }};'
                >
                  {{ section.settings.slide_3_button_text }}
                </a>
              </div>
            {% endif %}
          </div>
        </div>
      {% endif %}
    </swiper-slide>

    <!-- Autoplay Progress Indicator -->
    <div class='autoplay-progress' slot='container-end'>
      <svg viewBox='0 0 48 48'>
        <circle cx="24" cy="24" r="20"></circle>
      </svg>
      <span></span>
    </div>
    </swiper-container>
  </div>
</div>

<!-- Swiper Styles -->
<style>
  .hero-swiper {
    width: 100%;
    height: {{ section.settings.height_percent | default: 70 }}vh;
    border-radius: var(--hero-radius, 0px);
    overflow: hidden;
  }

  .hero-scale-wrap {
    width: 100%;
    height: {{ section.settings.height_percent | default: 70 }}vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    border-radius: var(--hero-radius, 0px);
  }

  /* Desktop: apply simple scale */
  .hero-scale-wrap .hero-swiper {
    transform: scale(calc(var(--hero-scale, 100) / 100));
    transform-origin: center center;
  }

  /* Ensure slides fill container and images cover */
  .hero-swiper swiper-slide {
    height: 100%;
  }
  .hero-swiper swiper-slide img {
    object-fit: cover;
    object-position: center center;
    border-radius: var(--hero-radius, 0px);
  }

  /* Inline text background overlay block */
  .kk-text-wrap {
    position: relative;
  }
  .kk-text-bg {
    position: absolute;
    inset: -0.5rem; /* small padding around text */
    border-radius: 0.5rem;
    z-index: -1;
  }
  .kk-text-content {
    position: relative;
    z-index: 1;
  }

  /* On mobile keep scaling and compensate dimensions to preserve cover */
  @media (max-width: 768px) {
    .hero-scale-wrap {
      height: {{ section.settings.height_percent | default: 70 }}vh;
      overflow: hidden;
    }
    .hero-scale-wrap .hero-swiper {
      width: calc(100% * var(--hero-scale-inv, 1));
      height: calc(100% * var(--hero-scale-inv, 1));
      transform: scale(calc(var(--hero-scale, 100) / 100));
    }
  }

  .hero-swiper swiper-slide {
    text-align: center;
    font-size: 18px;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .hero-swiper swiper-slide img {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .autoplay-progress {
    position: absolute;
    right: 16px;
    bottom: 16px;
    z-index: 20;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    color: #3b82f6;
  }

  .autoplay-progress svg {
    --progress: 0;
    position: absolute;
    left: 0;
    top: 0;
    z-index: 10;
    width: 100%;
    height: 100%;
    stroke-width: 4px;
    stroke: #3b82f6;
    fill: none;
    stroke-dashoffset: calc(125.6px * (1 - var(--progress)));
    stroke-dasharray: 125.6;
    transform: rotate(-90deg);
  }

  .autoplay-progress span {
    font-size: 12px;
    color: white;
  }

  /* Custom Pagination Styles */
  .hero-swiper .swiper-pagination-bullet {
    background: rgba(255, 255, 255, 0.5);
    opacity: 1;
  }

  .hero-swiper .swiper-pagination-bullet-active {
    background: #3b82f6;
  }
</style>

<!-- Initialize Swiper -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const progressCircle = document.querySelector('.autoplay-progress svg')
    const progressContent = document.querySelector('.autoplay-progress span')

    const swiperEl = document.querySelector('.hero-swiper')
    if (swiperEl) {
      swiperEl.addEventListener('autoplaytimeleft', e => {
        const [swiper, time, progress] = e.detail
        if (progressCircle) {
          progressCircle.style.setProperty('--progress', 1 - progress)
        }
        if (progressContent) {
          progressContent.textContent = `${Math.ceil(time / 1000)}s`
        }
      })
    }
  })
</script>

{% schema %}
{
  "name": "Hero Carousel",
  "settings": [
    {
      "type": "header",
      "content": "Carousel Settings"
    },
    {
      "type": "range",
      "id": "height_percent",
      "label": "Hero height (vh)",
      "min": 40,
      "max": 100,
      "step": 5,
      "default": 70
    },
    {
      "type": "range",
      "id": "autoplay_delay",
      "label": "Autoplay Delay (seconds)",
      "min": 2000,
      "max": 5000,
      "step": 500,
      "default": 5000
    },
    {
      "type": "range",
      "id": "scale_percent",
      "label": "Scale (%)",
      "min": 50,
      "max": 120,
      "step": 5,
      "default": 100
    },
    {
      "type": "range",
      "id": "scale_radius",
      "label": "Scaled border radius (px)",
      "min": 0,
      "max": 48,
      "step": 2,
      "default": 16
    },
    {
      "type": "checkbox",
      "id": "show_text_overlay",
      "label": "Show text overlay",
      "default": true
    },
    {
      "type": "header",
      "content": "Slide 1 Settings"
    },
    {
      "type": "checkbox",
      "id": "slide_1_button_enable",
      "label": "Slide 1: Show button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "slide_1_text_bg_enable",
      "label": "Slide 1: Enable text background",
      "default": false
    },
    {
      "type": "color",
      "id": "slide_1_text_bg_color",
      "label": "Slide 1: Text background color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "slide_1_text_bg_opacity",
      "label": "Slide 1: Text background opacity (%)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 50
    },
    {
      "type": "select",
      "id": "slide_1_text_shadow_strength",
      "label": "Slide 1 Text Shadow Strength",
      "options": [
        {"value":"none","label":"None"},
        {"value":"soft","label":"Soft"},
        {"value":"medium","label":"Medium"},
        {"value":"strong","label":"Strong"}
      ],
      "default": "soft"
    },
    {
      "type": "range",
      "id": "slide_1_text_shadow_blur",
      "label": "Slide 1 Text Shadow Blur (px)",
      "min": 0,
      "max": 24,
      "step": 1,
      "default": 6
    },
    {
      "type": "color",
      "id": "slide_1_text_color",
      "label": "Slide 1 Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "slide_1_button_bg_color",
      "label": "Slide 1 Button Background",
      "default": "#2563eb"
    },
    {
      "type": "color",
      "id": "slide_1_button_text_color",
      "label": "Slide 1 Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "image_picker",
      "id": "slide_1_image",
      "label": "Slide 1 Image"
    },
    {
      "type": "text",
      "id": "slide_1_title",
      "label": "Slide 1 Title",
      "default": "Premium Knives"
    },
    {
      "type": "textarea",
      "id": "slide_1_subtitle",
      "label": "Slide 1 Subtitle",
      "default": "Crafted with precision, designed for perfection"
    },
    {
      "type": "text",
      "id": "slide_1_button_text",
      "label": "Slide 1 Button Text",
      "default": "Shop Now"
    },
    {
      "type": "url",
      "id": "slide_1_button_url",
      "label": "Slide 1 Button URL"
    },
    {
      "type": "header",
      "content": "Slide 2 Settings"
    },
    {
      "type": "checkbox",
      "id": "slide_2_button_enable",
      "label": "Slide 2: Show button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "slide_2_text_bg_enable",
      "label": "Slide 2: Enable text background",
      "default": false
    },
    {
      "type": "color",
      "id": "slide_2_text_bg_color",
      "label": "Slide 2: Text background color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "slide_2_text_bg_opacity",
      "label": "Slide 2: Text background opacity (%)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 50
    },
    {
      "type": "select",
      "id": "slide_2_text_shadow_strength",
      "label": "Slide 2 Text Shadow Strength",
      "options": [
        {"value":"none","label":"None"},
        {"value":"soft","label":"Soft"},
        {"value":"medium","label":"Medium"},
        {"value":"strong","label":"Strong"}
      ],
      "default": "soft"
    },
    {
      "type": "range",
      "id": "slide_2_text_shadow_blur",
      "label": "Slide 2 Text Shadow Blur (px)",
      "min": 0,
      "max": 24,
      "step": 1,
      "default": 6
    },
    {
      "type": "color",
      "id": "slide_2_text_color",
      "label": "Slide 2 Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "slide_2_button_bg_color",
      "label": "Slide 2 Button Background",
      "default": "#2563eb"
    },
    {
      "type": "color",
      "id": "slide_2_button_text_color",
      "label": "Slide 2 Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "image_picker",
      "id": "slide_2_image",
      "label": "Slide 2 Image"
    },
    {
      "type": "text",
      "id": "slide_2_title",
      "label": "Slide 2 Title",
      "default": "Professional Grade"
    },
    {
      "type": "textarea",
      "id": "slide_2_subtitle",
      "label": "Slide 2 Subtitle",
      "default": "Tools that professionals trust"
    },
    {
      "type": "text",
      "id": "slide_2_button_text",
      "label": "Slide 2 Button Text",
      "default": "Explore Collection"
    },
    {
      "type": "url",
      "id": "slide_2_button_url",
      "label": "Slide 2 Button URL"
    },
    {
      "type": "header",
      "content": "Slide 3 Settings"
    },
    {
      "type": "checkbox",
      "id": "slide_3_button_enable",
      "label": "Slide 3: Show button",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "slide_3_text_bg_enable",
      "label": "Slide 3: Enable text background",
      "default": false
    },
    {
      "type": "color",
      "id": "slide_3_text_bg_color",
      "label": "Slide 3: Text background color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "slide_3_text_bg_opacity",
      "label": "Slide 3: Text background opacity (%)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 50
    },
    {
      "type": "select",
      "id": "slide_3_text_shadow_strength",
      "label": "Slide 3 Text Shadow Strength",
      "options": [
        {"value":"none","label":"None"},
        {"value":"soft","label":"Soft"},
        {"value":"medium","label":"Medium"},
        {"value":"strong","label":"Strong"}
      ],
      "default": "soft"
    },
    {
      "type": "range",
      "id": "slide_3_text_shadow_blur",
      "label": "Slide 3 Text Shadow Blur (px)",
      "min": 0,
      "max": 24,
      "step": 1,
      "default": 6
    },
    {
      "type": "color",
      "id": "slide_3_text_color",
      "label": "Slide 3 Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "slide_3_button_bg_color",
      "label": "Slide 3 Button Background",
      "default": "#2563eb"
    },
    {
      "type": "color",
      "id": "slide_3_button_text_color",
      "label": "Slide 3 Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "image_picker",
      "id": "slide_3_image",
      "label": "Slide 3 Image"
    },
    {
      "type": "text",
      "id": "slide_3_title",
      "label": "Slide 3 Title",
      "default": "Handcrafted Excellence"
    },
    {
      "type": "textarea",
      "id": "slide_3_subtitle",
      "label": "Slide 3 Subtitle",
      "default": "Every piece tells a story of craftsmanship"
    },
    {
      "type": "text",
      "id": "slide_3_button_text",
      "label": "Slide 3 Button Text",
      "default": "Learn More"
    },
    {
      "type": "url",
      "id": "slide_3_button_url",
      "label": "Slide 3 Button URL"
    }
  ],
  "presets": [
    {
      "name": "Hero Carousel"
    }
  ]
}
{% endschema %}
