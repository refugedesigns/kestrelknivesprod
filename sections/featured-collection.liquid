<div class='flex flex-col items-center my-8'>
  <h1 class='text-center text-3xl'>{{ section.settings.title }}</h1>

  <div class='max-w-6xl mx-auto flex flex-col items-center w-full'>
    <!-- Mobile Collection -->
    <div class='block md:hidden'>
      <div
        class='grid w-full gap-2 md:gap-6'
        style='grid-template-columns: repeat({{ section.settings.mobile_columns | default: 2 }}, 1fr);'
      >
        {% if section.settings.mobile_collection %}
          {% for product in section.settings.mobile_collection.products
            limit: section.settings.mobile_products_to_show
          %}
            {%- assign tags_lower = product.tags
              | join: "||"
              | downcase
              | split: "||"
            -%}
            {% unless tags_lower contains "hidden_offer" %}
              {% render "product-card-featured", product_product: product %}
            {% endunless %}
          {% else %}
            {% for item in (1..4) %}
              {% render "product-card-placeholder" %}
            {% endfor %}
          {% endfor %}
        {% else %}
          {% for item in (1..4) %}
            {% render "product-card-placeholder" %}
          {% endfor %}
        {% endif %}
      </div>
    </div>

    <!-- Tablet Collection -->
    <div class='hidden md:block lg:hidden'>
      <div
        class='grid w-full gap-2 md:gap-6'
        style='grid-template-columns: repeat({{ section.settings.tablet_columns | default: 2 }}, 1fr);'
      >
        {% assign tablet_collection = section.settings.tablet_collection
          | default: section.settings.featured_collection
        %}
        {% assign tablet_limit = section.settings.tablet_products_to_show
          | default: section.settings.number_of_products_to_show
        %}
        {% if tablet_collection %}
          {% for product in tablet_collection.products limit: tablet_limit %}
            {%- assign tags_lower = product.tags
              | join: "||"
              | downcase
              | split: "||"
            -%}
            {% unless tags_lower contains "hidden_offer" %}
              {% render "product-card-featured", product_product: product %}
            {% endunless %}
          {% else %}
            {% for item in (1..4) %}
              {% render "product-card-placeholder" %}
            {% endfor %}
          {% endfor %}
        {% else %}
          {% for item in (1..4) %}
            {% render "product-card-placeholder" %}
          {% endfor %}
        {% endif %}
      </div>
    </div>

    <!-- Desktop Collection -->
    <div class='hidden lg:block'>
      <div
        class='grid w-full gap-2 md:gap-6'
        style='grid-template-columns: repeat({{ section.settings.desktop_columns | default: 3 }}, 1fr);'
      >
        {% if section.settings.featured_collection %}
          {% for product in section.settings.featured_collection.products
            limit: section.settings.number_of_products_to_show
          %}
            {%- assign tags_lower = product.tags
              | join: "||"
              | downcase
              | split: "||"
            -%}
            {% unless tags_lower contains "hidden_offer" %}
              {% render "product-card-featured", product_product: product %}
            {% endunless %}
          {% else %}
            {% for item in (1..4) %}
              {% render "product-card-placeholder" %}
            {% endfor %}
          {% endfor %}
        {% else %}
          {% for item in (1..4) %}
            {% render "product-card-placeholder" %}
          {% endfor %}
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Featured Collection",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "default": "Featured Collection",
      "label": "Title"
    },
    {
      "type": "collection",
      "id": "featured_collection",
      "label": "Desktop Collection"
    },
    {
      "type": "range",
      "id": "number_of_products_to_show",
      "min": 3,
      "max": 12,
      "step": 1,
      "default": 3,
      "label": "Desktop: Number of products to show"
    },
    {
      "type": "header",
      "content": "Mobile Settings"
    },
    {
      "type": "collection",
      "id": "mobile_collection",
      "label": "Mobile Collection",
      "info": "Optional: Use a different collection for mobile. If not set, will use the desktop collection."
    },
    {
      "type": "range",
      "id": "mobile_products_to_show",
      "min": 2,
      "max": 8,
      "step": 1,
      "default": 4,
      "label": "Mobile: Number of products to show"
    },
    {
      "type": "range",
      "id": "mobile_columns",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 2,
      "label": "Mobile: Number of columns"
    },
    {
      "type": "header",
      "content": "Tablet Settings"
    },
    {
      "type": "collection",
      "id": "tablet_collection",
      "label": "Tablet Collection",
      "info": "Optional: Use a different collection for tablet. If not set, will use the desktop collection."
    },
    {
      "type": "range",
      "id": "tablet_products_to_show",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 4,
      "label": "Tablet: Number of products to show"
    },
    {
      "type": "range",
      "id": "tablet_columns",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 2,
      "label": "Tablet: Number of columns"
    },
    {
      "type": "range",
      "id": "desktop_columns",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 3,
      "label": "Desktop: Number of columns"
    },
    {
      "type": "header",
      "content": "Color Variant Images"
    },
    {
      "type": "image_picker",
      "id": "orange_image",
      "label": "Orange Color Image",
      "info": "Upload an image for orange color variants"
    },
    {
      "type": "image_picker",
      "id": "black_orange_image",
      "label": "Black w/Orange Liner Image",
      "info": "Upload an image for black with orange liner variants"
    },
    {
      "type": "image_picker",
      "id": "black_image",
      "label": "Black Color Image",
      "info": "Upload an image for black color variants"
    },
    {
      "type": "image_picker",
      "id": "green_image",
      "label": "Green Color Image",
      "info": "Upload an image for green color variants"
    },
    {
      "type": "image_picker",
      "id": "camo_image",
      "label": "Camo/Earth Color Image",
      "info": "Upload an image for camo or earth color variants"
    },
    { "type": "header", "content": "Card color override images" },
    {
      "type": "image_picker",
      "id": "high_vis_orange_image",
      "label": "High Vis Orange Image"
    },
    {
      "type": "image_picker",
      "id": "high_vis_green_image",
      "label": "High Vis Green Image"
    }
  ],
  "presets": [
    {
      "name": "Featured Collection"
    }
  ]
}
{% endschema %}
