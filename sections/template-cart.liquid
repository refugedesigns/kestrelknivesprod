{% if cart.item_count > 0 %}
  <main class='max-w-7xl mx-auto lg:px-8 py-8'>
    <div class='flex flex-col lg:flex-row gap-8 lg:gap-12'>
      <!-- Cart Items -->
      <div class='flex-1 lg:w-2/3'>
        <div class='bg-white rounded-lg shadow-sm'>
          <!-- Cart Header -->
          <div class='px-6 py-4 border-b border-gray-200'>
            <div class='flex items-center justify-between'>
              <h1 class='text-2xl font-bold text-gray-900'>Your Cart</h1>
              <a
                href='{{ routes.all_products_collection_url }}'
                class='text-black hover:text-gray-800 font-medium text-sm transition-colors'
              >
                Continue Shopping
              </a>
            </div>
          </div>

          <form action='{{ routes.cart_url }}' method='post' novalidate>
            <!-- Cart Items List -->
            <div class='divide-y divide-gray-200'>
              {% for item in cart.items %}
                <div class='p-6'>
                  <div class='flex items-start space-x-4'>
                    <!-- Product Image -->
                    <div class='flex-shrink-0 w-24 h-24 bg-gray-100 rounded-lg overflow-hidden'>
                      <a href='{{ item.url }}'>
                        {% if item.image %}
                          <img
                            src='{{ item.image | img_url: '200x200' }}'
                            alt='{{ item.product.title | escape }}'
                            class='w-full h-full object-contain'
                          >
                        {% else %}
                          {{
                            "product-1"
                            | placeholder_svg_tag: "w-full h-full object-contain"
                          }}
                        {% endif %}
                      </a>
                    </div>

                    <!-- Product Details -->
                    <div class='flex-1 min-w-0'>
                      <div class='flex items-start justify-between mb-4'>
                        <div class='flex-1'>
                          <a
                            href='{{ item.url }}'
                            class='text-lg font-semibold text-gray-900 mb-1 block'
                          >
                            {{- item.product.title -}}
                          </a>
                          {% if item.variant.title
                            and item.variant.title != "Default Title"
                          %}
                            <p class='text-sm text-gray-600 mb-2'>
                              Variant:
                              <span class='font-medium text-gray-900'>
                                {{- item.variant.title -}}
                              </span>
                            </p>
                          {% endif %}
                          <div class='flex items-center space-x-4 text-sm text-gray-600'>
                            {% if item.sku -%}
                              <span>SKU: {{ item.sku }}</span>
                            {%- endif %}
                          </div>
                        </div>
                        <div class='text-right ml-4'>
                          <p class='text-lg font-bold text-gray-900'>
                            {{ item.final_price | money }}
                          </p>
                          <p class='text-sm text-gray-500'>Each</p>
                        </div>
                      </div>

                      <!-- Quantity and Actions -->
                      <div class='flex flex-wrap items-center justify-between gap-3'>
                        <div class='flex items-center space-x-3 flex-shrink-0'>
                          <label class='text-sm font-medium text-gray-700'
                            >Quantity:</label
                          >
                          <div class='flex items-center border border-gray-300 rounded-md'>
                            <button
                              type='button'
                              class='p-2 hover:bg-gray-50 transition-colors'
                              onclick="var i=document.getElementById('updates_{{ forloop.index }}'); if(i && i.value>0){ i.stepDown(); }"
                            >
                              <svg
                                class='w-4 h-4'
                                fill='none'
                                stroke='currentColor'
                                viewBox='0 0 24 24'
                              >
                                <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M20 12H4'></path>
                              </svg>
                            </button>
                            <input
                              id='updates_{{ forloop.index }}'
                              name='updates[]'
                              type='number'
                              value='{{ item.quantity }}'
                              min='0'
                              class='w-16 text-center border-0 focus:ring-0 py-2'
                            >
                            <button
                              type='button'
                              class='p-2 hover:bg-gray-50 transition-colors'
                              onclick="var i=document.getElementById('updates_{{ forloop.index }}'); if(i){ i.stepUp(); }"
                            >
                              <svg
                                class='w-4 h-4'
                                fill='none'
                                stroke='currentColor'
                                viewBox='0 0 24 24'
                              >
                                <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 4v16m8-8H4'></path>
                              </svg>
                            </button>
                          </div>
                        </div>

                        <a
                          href='{{ routes.cart_change_url }}?line={{ forloop.index }}&quantity=0'
                          class='text-sm text-red-600 hover:text-red-700 transition-colors flex items-center ml-auto'
                        >
                          <svg
                            class='w-4 h-4 mr-1'
                            fill='none'
                            stroke='currentColor'
                            viewBox='0 0 24 24'
                          >
                            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16'></path>
                          </svg>
                          Remove
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>

            <!-- Cart Notes -->
            <div class='p-6 border-t border-gray-200'>
              <label class='block text-sm font-medium text-gray-700 mb-2'
                >Order Notes (Optional)</label
              >
              <textarea
                name='note'
                rows='3'
                class='w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-black focus:border-black resize-none'
                placeholder='Add any special instructions for your order...'
              >{{ cart.note }}</textarea>
            </div>

            <!-- Mobile Summary Buttons -->
            <div class='p-6 border-t border-gray-200 lg:hidden space-y-3'>
              <button
                type='submit'
                name='checkout'
                class='w-full bg-black hover:bg-gray-800 text-white font-semibold py-4 px-6 rounded-md transition-colors duration-200'
              >
                Proceed to Checkout
              </button>
              <button
                type='submit'
                name='update'
                class='w-full border border-gray-300 hover:border-gray-400 text-gray-700 font-medium py-3 px-6 rounded-md transition-colors'
              >
                Update Cart
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Order Summary -->
      <div class='lg:w-1/3 mt-8 lg:mt-0'>
        <div class='bg-white rounded-lg shadow-sm sticky top-24'>
          <!-- Summary Header -->
          <div class='px-6 py-4 border-b border-gray-200'>
            <h2 class='text-lg font-semibold text-gray-900'>Order Summary</h2>
          </div>

          <!-- Summary Details -->
          <div class='p-6 space-y-4'>
            <div class='flex justify-between text-sm'>
              <span class='text-gray-600'
                >Subtotal ({{ cart.item_count }}
                {{ cart.item_count | pluralize: "item", "items" }})</span
              >
              <span class='font-medium text-gray-900'>
                {{- cart.total_price | money -}}
              </span>
            </div>
            <div class='flex justify-between text-sm'>
              <span class='text-gray-600'>Shipping</span>
              <span class='font-medium text-gray-900'
                >Calculated at checkout</span
              >
            </div>
            <div class='flex justify-between text-sm'>
              <span class='text-gray-600'>Tax</span>
              <span class='font-medium text-gray-900'
                >Calculated at checkout</span
              >
            </div>
          </div>

          <!-- Checkout Buttons -->
          <form
            action='{{ routes.cart_url }}'
            method='post'
            novalidate
            class='p-6 border-t border-gray-200'
          >
            <button
              type='submit'
              name='checkout'
              class='w-full bg-black hover:bg-gray-800 text-white font-semibold py-4 px-6 rounded-md transition-colors duration-200 mb-3'
            >
              Proceed to Checkout
            </button>
            <button
              type='submit'
              name='update'
              class='w-full border border-gray-300 hover:border-gray-400 text-gray-700 font-medium py-3 px-6 rounded-md transition-colors'
            >
              Update Cart
            </button>
          </form>
        </div>
      </div>
    </div>
  </main>
{% else %}
  <div class='max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 text-center'>
    <div class='max-w-md mx-auto'>
      <svg
        class='w-24 h-24 mx-auto text-gray-300 mb-4'
        fill='none'
        stroke='currentColor'
        viewBox='0 0 24 24'
      >
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='1' d='M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5M7 13v6a2 2 0 002 2h6a2 2 0 002-2v-6m-8 0V9a2 2 0 012-2h4a2 2 0 012 2v4.01'></path>
      </svg>
      <h2 class='text-2xl font-semibold text-gray-900 mb-2'>
        Your cart is empty
      </h2>
      <p class='text-gray-600 mb-6'>
        Looks like you haven't added any items to your cart yet.
      </p>
      <a
        href='{{ routes.root_url }}'
        class='inline-flex items-center px-6 py-3 bg-black hover:bg-gray-800 text-white font-medium rounded-md transition-colors'
      >
        Continue Shopping
      </a>
    </div>
  </div>
{% endif %}

{% schema %}
{
  "name": "Cart Template",
  "blocks": [
    { "type": "subtotal", "name": "Subtotal", "limit": 1 },
    { "type": "checkout_button", "name": "Checkout Button", "limit": 1 },
    { "type": "update_button", "name": "Update Button", "limit": 1 }
  ]
}
{% endschema %}
